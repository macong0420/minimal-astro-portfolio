import { getCollection } from 'astro:content';
import BaseLayout from '../../components/layout/BaseLayout.astro';

// 添加 getStaticPaths 函数
export async function getStaticPaths() {
  const blogEntries = await getCollection('blog');
  return blogEntries.map(entry => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}

// 获取当前页面的数据
const { entry } = Astro.props;
const { Content } = await entry.render();

// 格式化日期函数
const formatDate = (date) => {
  return new Date(date).toLocaleDateString('zh-CN', {
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  });
};

<BaseLayout title={entry.data.title} description={entry.data.description}>
  <article class="blog-post">
    <header>
      <h1>{entry.data.title}</h1>
      <time datetime={entry.data.publishedAt.toISOString()}>
        {formatDate(entry.data.publishedAt)}
      </time>
    </header>
    
    <div class="blog-content">
      <Content />
    </div>
  </article>
</BaseLayout>

<style>
  .blog-post {
    padding: 0 1.5rem;
    max-width: 768px;
    margin: 0 auto;
    width: 100%;
  }

  .blog-content {
    margin-top: 2rem;
    padding: 0 1.5rem;
  }

  h1 {
    font-size: 2.5rem;
    line-height: 1.2;
    margin-bottom: 1rem;
    padding: 0 1.5rem;
  }

  time {
    color: var(--text-muted);
    font-size: 0.9rem;
    padding: 0 1.5rem;
    display: block;
  }

  header {
    margin-bottom: 2rem;
    padding: 0 1.5rem;
  }

  @media (max-width: 640px) {
    .blog-post {
      padding: 0 1.5rem;
    }
    
    .blog-content {
      padding: 0 1.5rem;
    }
    
    h1 {
      font-size: 2rem;
      padding: 0 1.5rem;
    }
    
    header {
      padding: 0 1.5rem;
    }
  }
</style> 