---
title: "ç¬¬ä¸€æˆ˜ï¼šiOS åº•å±‚åŸç†æ·±åº¦å‰–æ (Runtime & Memory)"
description: "æ¶ˆæ¯å‘é€æœºåˆ¶ã€ç±»ç»“æ„ã€æ–¹æ³•ç¼“å­˜ã€åŠ¨æ€ç‰¹æ€§"
publishedAt: 2025-11-20
tags:
  - "iOS"
  - " é¢è¯•"
---

![image.png](https://raw.githubusercontent.com/macong0420/Image/main/20251120114203161.png)

## **1ï¸âƒ£ Runtimeï¼ˆObjective-C å¿ƒè„ï¼‰**

**æ ¸å¿ƒè€ƒç‚¹**ï¼šæ¶ˆæ¯å‘é€æœºåˆ¶ã€ç±»ç»“æ„ã€æ–¹æ³•ç¼“å­˜ã€åŠ¨æ€ç‰¹æ€§

***

```mermaid
mindmap
  root((P7/P8 iOS åº•å±‚é¢è¯•å…¨æ™¯çŸ¥è¯†åœ°å›¾))
    Runtimeï¼ˆObjective-C å¿ƒè„ï¼‰
      æ¶ˆæ¯å‘é€æœºåˆ¶ï¼ˆobjc_msgSendï¼‰
        å¿«é€Ÿè·¯å¾„ï¼ˆæ±‡ç¼–ï¼‰
        æ…¢é€Ÿè·¯å¾„ï¼ˆC++ï¼‰
        æ·±æŒ–é¢˜ Q1: ä¸ºä»€ä¹ˆç”¨æ±‡ç¼–å†™
          è¯¦ç»†è§£ç­”: æ€§èƒ½ä¼˜åŒ–, çµæ´»æ€§, å¹³å°é€‚é…
      ç±»å¯¹è±¡ç»“æ„
        isa é“¾
        class_data_bits_t
        æ·±æŒ–é¢˜ Q3: isa_t ä½åŸŸç»“æ„
          è¯¦ç»†è§£ç­”: ä½åŸŸå­—æ®µè¯´æ˜
      æ–¹æ³•ç¼“å­˜ï¼ˆcache_tï¼‰
        æ‰©å®¹æœºåˆ¶
        æ·˜æ±°ç­–ç•¥
        æ·±æŒ–é¢˜ Q2: cache_t æ‰©å®¹æœºåˆ¶
          è¯¦ç»†è§£ç­”: è§¦å‘æ¡ä»¶, æ‰©å®¹è¿‡ç¨‹, å“ˆå¸Œå†²çªå¤„ç†
      ç±»åŠ è½½è¿‡ç¨‹ï¼ˆ+load / +initializeï¼‰
      Category åº•å±‚å®ç°
    å†…å­˜ç®¡ç†ï¼ˆARC èƒŒåçš„æœºåˆ¶ï¼‰
      å¼•ç”¨è®¡æ•°å­˜å‚¨
        Tagged Pointer
        isa.extra_rc
        SideTables
      Weak å¼•ç”¨é”€æ¯æµç¨‹
        æ·±æŒ–é¢˜ Q4: Weak å¼•ç”¨é”€æ¯æµç¨‹
          è¯¦ç»†è§£ç­”: dealloc æµç¨‹, clearDeallocating
      AutoreleasePool åŸç†
        æ·±æŒ–é¢˜ Q5: AutoreleasePool åŸç†
          è¯¦ç»†è§£ç­”: ç»“æ„, push, autorelease, pop, RunLoop
      Associated Objects åŸç†
        æ·±æŒ–é¢˜ Q6: Associated Objects åŸç†
          è¯¦ç»†è§£ç­”: å­˜å‚¨ç»“æ„, é‡Šæ”¾æµç¨‹
    Blockï¼ˆé—­åŒ…ä¸æ•è·ï¼‰
      Block ç±»å‹ï¼ˆGlobal / Stack / Mallocï¼‰
      æ•è·æœºåˆ¶
      __block åŸç†
        æ·±æŒ–é¢˜ Q7: __block åŸç†
          è¯¦ç»†è§£ç­”: __Block_byref ç»“æ„ä½“, forwarding æŒ‡é’ˆ
      Block å†…å­˜å¸ƒå±€
        æ·±æŒ–é¢˜ Q8: Block å†…å­˜å¸ƒå±€
          è¯¦ç»†è§£ç­”: Block_layout, descriptor
      å¾ªç¯å¼•ç”¨
        æ·±æŒ–é¢˜ Q9: Block å¾ªç¯å¼•ç”¨æ£€æµ‹ä¸è§£å†³
          è¯¦ç»†è§£ç­”: æ£€æµ‹æ–¹æ³•, è§£å†³æ–¹æ¡ˆ
    å»¶ä¼¸åº•å±‚æœºåˆ¶
      KVO åŸç†
        æ·±æŒ–é¢˜ Q10: KVO åº•å±‚åŸç†
          è¯¦ç»†è§£ç­”: åŠ¨æ€å­ç±», setter é‡å†™, é‡Šæ”¾æ¢å¤
      GCD åº•å±‚
        æ·±æŒ–é¢˜ Q11: dispatch_once åº•å±‚
          è¯¦ç»†è§£ç­”: pthread_once, CAS
      å†…å­˜å¯¹é½ä¸å¯¹è±¡å¸ƒå±€
        æ·±æŒ–é¢˜ Q12: å†…å­˜å¯¹é½è§„åˆ™
          è¯¦ç»†è§£ç­”: å¯¹é½åŸåˆ™, æ€§èƒ½æå‡
```

### **1.1 æ¶ˆæ¯å‘é€æœºåˆ¶ï¼ˆobjc\_msgSendï¼‰**

- **è°ƒç”¨æµç¨‹**ï¼š\
  `[obj foo] â†’ objc_msgSend(obj, @selector(foo))`
- **å¿«é€Ÿè·¯å¾„ï¼ˆæ±‡ç¼–ï¼‰**ï¼š
  1. æ£€æŸ¥ obj æ˜¯å¦ä¸º nilï¼ˆnil æ¶ˆæ¯å®‰å…¨ï¼‰ã€‚
  2. é€šè¿‡Â `isa`Â æ©ç ï¼ˆISA\_MASKï¼‰æ‰¾åˆ° Classã€‚
  3. åœ¨ Cacheï¼ˆBucketsï¼‰ä¸­å“ˆå¸ŒæŸ¥æ‰¾ IMPã€‚
  4. å“ˆå¸Œå†²çªè§£å†³ï¼šå¼€æ”¾å¯»å€æ³•ï¼ˆå‘åæ‰¾ï¼Œå›åˆ°å¤´éƒ¨ï¼‰ã€‚
- **æ…¢é€Ÿè·¯å¾„ï¼ˆC++ï¼‰**ï¼š
  - `lookUpImpOrForward`Â â†’ äºŒåˆ†æŸ¥æ‰¾ method\_list â†’ é€’å½’æŸ¥æ‰¾çˆ¶ç±»ã€‚
  - åŠ¨æ€æ–¹æ³•å†³è®®ï¼š`resolveInstanceMethod`ã€‚
  - æ¶ˆæ¯è½¬å‘ï¼š`forwardingTargetForSelector`Â â†’Â `methodSignatureForSelector`Â â†’Â `forwardInvocation`ã€‚

ğŸ’£Â **æ·±æŒ–é¢˜ Q1: ä¸ºä»€ä¹ˆ objc\_msgSend ç”¨æ±‡ç¼–å†™ï¼Ÿ**\
**è¯¦ç»†è§£ç­”**ï¼š

1. **æ€§èƒ½ä¼˜åŒ–**
   - C è¯­è¨€å‡½æ•°è°ƒç”¨éœ€è¦å»ºç«‹æ ˆå¸§ï¼Œè€ŒÂ `objc_msgSend`Â åªæ˜¯æŸ¥æ‰¾ IMP å¹¶è·³è½¬ï¼Œä¸éœ€è¦é¢å¤–æ ˆå¸§ã€‚
   - æ±‡ç¼–å¯ç›´æ¥æ“ä½œå¯„å­˜å™¨ï¼ˆARM64 çš„ x0, x1, x2...ï¼‰ï¼Œé¿å…å‚æ•°æ¬è¿åˆ°æ ˆä¸Šã€‚
   - æ¶ˆæ¯å‚æ•°æ˜¯å˜é•¿çš„ï¼ŒC è¯­è¨€å¤„ç†å˜é•¿å‚æ•°éœ€è¦é¢å¤–å¼€é”€ï¼Œæ±‡ç¼–å¯ç›´æ¥æŒ‰å¯„å­˜å™¨åè®®ä¼ é€’ã€‚
2. **çµæ´»æ€§**
   - æ±‡ç¼–å¯ç›´æ¥Â `jmp`Â åˆ° IMPï¼Œå‡å°‘ä¸€æ¬¡å‡½æ•°è¿”å›å¼€é”€ã€‚
   - å¯å†…è”å¿«é€Ÿè·¯å¾„ï¼Œé¿å…å‡½æ•°è°ƒç”¨å±‚å±‚åµŒå¥—ã€‚
3. **å¹³å°é€‚é…**
   - Apple ä¸ºä¸åŒæ¶æ„åˆ†åˆ«å†™äº†é«˜åº¦ä¼˜åŒ–çš„æ±‡ç¼–ç‰ˆæœ¬ã€‚

***

### **1.2 ç±»å¯¹è±¡ç»“æ„**

- **isa é“¾**ï¼š

  ```
  Instance â†’ Class â†’ MetaClass â†’ RootMetaClass â†’ RootMetaClassï¼ˆè‡ªæŒ‡ï¼‰
  ```

- **class\_data\_bits\_t**ï¼š
  - å­˜å‚¨ methodsã€propertiesã€protocolsã€‚

- **isa ä½åŸŸï¼ˆnon-pointer isaï¼‰**ï¼š
  - åŒ…å«å¼•ç”¨è®¡æ•°æ ‡è®°ã€æ˜¯å¦æœ‰ weak å¼•ç”¨ã€æ˜¯å¦æ­£åœ¨ææ„ç­‰ä¿¡æ¯ã€‚

ğŸ’£Â **æ·±æŒ–é¢˜ Q3: isa\_t ä½åŸŸç»“æ„ï¼Ÿ**\
**è¯¦ç»†è§£ç­”**ï¼š

```C++
union isa_t {     
    uintptr_t bits;  // è§†è§’ Aï¼šåŸå§‹æ•°æ®ï¼ˆçœ‹ä½œä¸€ä¸ª 64 ä½çš„æ•´æ•°ï¼‰
    struct {         // è§†è§’ Bï¼šç²¾ç»†åŒ–æ•°æ®ï¼ˆçœ‹ä½œ 64 ä¸ªç‹¬ç«‹çš„å¼€å…³ï¼‰
        // ... é‡Œé¢çš„ä½åŸŸ ...
    }; 
};
```

- `nonpointer`ï¼šæ˜¯å¦å¯ç”¨ä½åŸŸä¼˜åŒ–ã€‚
- `shiftcls`ï¼šç±»æŒ‡é’ˆï¼ˆä½ç§»å­˜å‚¨ï¼‰ã€‚
- `extra_rc`ï¼šå¼•ç”¨è®¡æ•°ã€‚
- `has_sidetable_rc`ï¼šæ˜¯å¦æœ‰ SideTable å¼•ç”¨è®¡æ•°ã€‚
- `weakly_referenced`ï¼šæ˜¯å¦æœ‰ weak å¼•ç”¨ã€‚
- `deallocating`ï¼šæ˜¯å¦æ­£åœ¨ææ„ã€‚

- **unionÂ (å…±ç”¨ä½“)**ï¼šè¿™æ„å‘³ç€Â bitsÂ å’Œä¸‹é¢çš„Â structÂ **å…±ç”¨åŒä¸€å— 8 å­—èŠ‚ï¼ˆ64ä½ï¼‰çš„å†…å­˜**ã€‚

- **äº’é€šæ€§**ï¼š

  - å½“ä½ å†™Â isa.bits = 0x...Â æ—¶ï¼Œä½ æ˜¯åœ¨ä¸€æ¬¡æ€§æ“ä½œæ•´ä¸ª 64 ä½æ•°æ®ã€‚

  - å½“ä½ è¯»Â isa.extra\_rcÂ æ—¶ï¼Œä½ æ˜¯åœ¨ç²¾å‡†è¯»å–è¿™ 64 ä½ä¸­æœ€é«˜çš„ 19 ä½ã€‚

- **uintptr\_t**ï¼šåœ¨ 64 ä½ç³»ç»Ÿä¸‹ï¼Œç­‰åŒäºÂ unsigned long longï¼ˆæ— ç¬¦å·é•¿æ•´å‹ï¼‰ï¼Œå  64 bitã€‚

- **: 1Â (ä½åŸŸ)**ï¼šå†’å·åé¢çš„æ•°å­—è¡¨ç¤ºè¯¥æˆå‘˜**å ç”¨å‡ ä¸ªäºŒè¿›åˆ¶ä½ (bit)**ã€‚åŠ èµ·æ¥åˆšå¥½ 64 ä½ã€‚



***

### **1.3 æ–¹æ³•ç¼“å­˜ï¼ˆcache\_tï¼‰**

- **æ‰©å®¹**ï¼šå ç”¨è¶…è¿‡ 3/4 â†’ æ‰©å®¹ä¸ºåŸæ¥çš„ 2 å€ â†’ æ¸…ç©ºæ—§ç¼“å­˜ã€‚
- **æ·˜æ±°ç­–ç•¥**ï¼šæ—  LRUï¼Œå†²çªæ—¶ç›´æ¥è¦†ç›–æ—§å€¼ã€‚

ğŸ’£Â **æ·±æŒ–é¢˜ Q2: cache\_t æ‰©å®¹æœºåˆ¶ï¼Ÿ**\
**è¯¦ç»†è§£ç­”**ï¼š

1. **è§¦å‘æ¡ä»¶**ï¼šç¼“å­˜å ç”¨è¶…è¿‡å®¹é‡çš„ 3/4ã€‚
2. **æ‰©å®¹è¿‡ç¨‹**ï¼š
   - æ–°å®¹é‡ = åŸå®¹é‡ Ã— 2ã€‚
   - æ¸…ç©ºæ—§ç¼“å­˜ï¼ˆå“ˆå¸Œç´¢å¼•ä¾èµ– capacityï¼Œæ‰©å®¹åç´¢å¼•å…¨å˜ï¼Œé‡æ–°è®¡ç®—ä¸å¦‚æ¸…ç©ºå¿«ï¼‰ã€‚
3. **å“ˆå¸Œå†²çªå¤„ç†**ï¼šå¼€æ”¾å¯»å€æ³•ï¼Œå†²çªæ—¶å‘åæ‰¾ç©ºä½ï¼Œæœ«å°¾å›åˆ°å¤´éƒ¨ç»§ç»­æ‰¾ã€‚

***

### **1.4 ç±»åŠ è½½è¿‡ç¨‹**

- **+load**ï¼š
  - åœ¨ image åŠ è½½æ—¶è°ƒç”¨ï¼ŒæŒ‰ä¾èµ–é¡ºåºï¼Œçº¿ç¨‹å®‰å…¨ã€‚
- **+initialize**ï¼š
  - åœ¨ç±»ç¬¬ä¸€æ¬¡æ¥æ”¶æ¶ˆæ¯æ—¶è°ƒç”¨ï¼Œçº¿ç¨‹å®‰å…¨ï¼Œå¯è¢«ç»§æ‰¿ã€‚

***

### **1.5 Category åº•å±‚å®ç°**

- æ–¹æ³•æ’å…¥åˆ°ç±»çš„ method\_listï¼ˆä¼˜å…ˆäºåŸç±»æ–¹æ³•ï¼‰ã€‚
- ä¸èƒ½æ·»åŠ å®ä¾‹å˜é‡ï¼ˆå†…å­˜å¸ƒå±€å·²å›ºå®šï¼‰ã€‚

***

## **2ï¸âƒ£ å†…å­˜ç®¡ç†ï¼ˆARC èƒŒåçš„æœºåˆ¶ï¼‰**

**æ ¸å¿ƒè€ƒç‚¹**ï¼šå¼•ç”¨è®¡æ•°å­˜å‚¨ã€SideTablesã€Weak å¼•ç”¨ã€AutoreleasePool

***

### **2.1 å¼•ç”¨è®¡æ•°å­˜å‚¨**

- **Tagged Pointer**ï¼šå°å¯¹è±¡ç›´æ¥å­˜æŒ‡é’ˆï¼Œæ— å¼•ç”¨è®¡æ•°ã€‚
- **isa.extra\_rc**ï¼šä½åŸŸå­˜å‚¨å¼•ç”¨è®¡æ•°ï¼Œæº¢å‡ºåè¿›å…¥ SideTableã€‚
- **SideTables**ï¼š
  - å…¨å±€ StripeMapï¼ˆåˆ†æ®µé”å“ˆå¸Œè¡¨ï¼‰ã€‚
  - åŒ…å« RefcountMap å’Œ WeakTableã€‚

***

### **2.2 Weak å¼•ç”¨é”€æ¯æµç¨‹**

ğŸ’£Â **æ·±æŒ–é¢˜ Q4: Weak å¼•ç”¨é”€æ¯æµç¨‹ï¼Ÿ**\
**è¯¦ç»†è§£ç­”**ï¼š

1. å¯¹è±¡Â `dealloc`Â â†’Â `_objc_rootDealloc`ã€‚
2. æ£€æŸ¥Â `isa.weakly_referenced`Â ä½æ ‡è®°ã€‚
3. å¦‚æœæœ‰ weak å¼•ç”¨ï¼š
   - è°ƒç”¨Â `object_dispose`Â â†’Â `objc_destructInstance`Â â†’Â `clearDeallocating`ã€‚
4. `clearDeallocating`ï¼š
   - è·å–å¯¹è±¡åœ°å€å¯¹åº”çš„ SideTableã€‚
   - åœ¨ WeakTable ä¸­æŸ¥æ‰¾è¯¥å¯¹è±¡çš„ entryã€‚
   - éå† entry ä¸­çš„æ‰€æœ‰ weak æŒ‡é’ˆåœ°å€ï¼Œå°†å®ƒä»¬ç½®ä¸º nilã€‚
   - ç§»é™¤ entryï¼Œé‡Šæ”¾é”ã€‚


ç®€å•æ¥è¯´ï¼Œ`SideTables` çš„æ•°é‡é™åˆ¶ï¼ˆ64 æˆ– 8ï¼‰æ˜¯ **â€œé”ç«äº‰â€** ä¸ **â€œå†…å­˜å¼€é”€â€** ä¹‹é—´çš„ä¸€ä¸ª**é»„é‡‘å¹³è¡¡ç‚¹**ã€‚è¿™å°±æ˜¯ç»å…¸çš„ **åˆ†æ®µé”ï¼ˆLock Stripingï¼‰** æŠ€æœ¯ã€‚

ä»¥ä¸‹æ˜¯é€‚åˆâ€œé«˜çº§å·¥ç¨‹å¸ˆ/æ¶æ„å¸ˆâ€é¢è¯•çš„æ·±åº¦å›ç­”é€»è¾‘ï¼š

***

### 1. æ ¸å¿ƒè®¾è®¡æ¨¡å¼ï¼šåˆ†æ®µé” (Lock Striping)

**é¢è¯•å®˜é—®**ï¼šâ€œä¸ºä»€ä¹ˆä¸ç›´æ¥ç”¨ä¸€ä¸ªå…¨å±€çš„å¤§è¡¨ï¼Ÿæˆ–è€…ç»™æ¯ä¸ªå¯¹è±¡é…ä¸€ä¸ªè¡¨ï¼Ÿâ€

**ä½ çš„å›ç­”**ï¼š

- **æ–¹æ¡ˆ Aï¼šå…¨å±€ä¸€å¼ è¡¨ (One Global Table)**

  - å¦‚æœæœ‰æˆåƒä¸Šä¸‡ä¸ªå¯¹è±¡åŒæ—¶è¿›è¡Œ `retain/release` æˆ– `weak` æ“ä½œï¼Œæ‰€æœ‰çº¿ç¨‹éƒ½è¦æŠ¢**åŒä¸€æŠŠé”**ã€‚

  - **ç»“æœ**ï¼šä¸¥é‡çš„é”ç«äº‰ï¼ˆLock Contentionï¼‰ï¼Œå¤šæ ¸ CPU å˜æˆä¸²è¡Œæ‰§è¡Œï¼Œæ€§èƒ½å´©å¡Œã€‚
- **æ–¹æ¡ˆ Bï¼šæ¯å¯¹è±¡ä¸€è¡¨ (One Table per Object)**

  - ç»™æ¯ä¸ªå¯¹è±¡åˆ†é…ç‹¬ç«‹çš„é”å’Œè¡¨ã€‚

  - **ç»“æœ**ï¼šå†…å­˜çˆ†ç‚¸ã€‚å¤§éƒ¨åˆ†å¯¹è±¡å¯èƒ½æ ¹æœ¬ä¸éœ€è¦å­˜ weak æŒ‡é’ˆï¼Œè¿™æ˜¯æå¤§çš„æµªè´¹ã€‚
- **æ–¹æ¡ˆ Cï¼šSideTables (åˆ†æ®µé”)**

  - Runtime é€‰æ‹©äº†æŠ˜ä¸­æ–¹æ¡ˆï¼šå°†æ‰€æœ‰å¯¹è±¡çš„å¼•ç”¨è®¡æ•°è¡¨â€œåˆ‡åˆ†â€æˆå›ºå®šæ•°é‡çš„æ¡¶ï¼ˆBucketsï¼‰ã€‚

  - **64** ä¸ªè¡¨æ„å‘³ç€ï¼šç†è®ºä¸Šæ”¯æŒ **64 ä¸ªçº¿ç¨‹åŒæ—¶**å¹¶å‘æ“ä½œ**ä¸åŒå¯¹è±¡**çš„å¼•ç”¨è®¡æ•°ï¼Œè€Œäº’ä¸å¹²æ‰°ã€‚

***

### 2. ä¸ºä»€ä¹ˆæ˜¯ 64 å’Œ 8ï¼Ÿ(æ¶æ„å·®å¼‚)

è¿™ä¸ªæ•°å­—æ˜¯åœ¨ Runtime æºç çš„ `StripedMap` æ¨¡ç‰ˆä¸­å®šä¹‰çš„ï¼š

- **iPhone (64-bit) / Mac**: **64 ä¸ª**

  - ç°ä»£è®¾å¤‡å†…å­˜å……è¶³ï¼Œä¸” CPU æ ¸å¿ƒæ•°è¾ƒå¤šï¼ˆ6æ ¸ã€8æ ¸ç­‰ï¼‰ã€‚

  - 64 ä¸ªæ§½ä½è¶³ä»¥ä¿è¯å“ˆå¸Œå†²çªï¼ˆä¸¤ä¸ªæ— å…³å¯¹è±¡æ˜ å°„åˆ°åŒä¸€ä¸ªè¡¨ï¼‰çš„æ¦‚ç‡æä½ï¼Œå¹¶å‘æ€§èƒ½æœ€ä¼˜ã€‚
- **Legacy iPhone (32-bit)**: **8 ä¸ª**

  - è€æ—§è®¾å¤‡ï¼ˆå¦‚ iPhone 4S/5ï¼‰å†…å­˜éå¸¸åƒç´§ï¼ŒCPU ä¹Ÿæ˜¯åŒæ ¸æˆ–å•æ ¸ã€‚

  - 8 ä¸ªè¡¨è¶³ä»¥åº”ä»˜å½“æ—¶çš„å¹¶å‘éœ€æ±‚ï¼ŒåŒæ—¶èŠ‚çœå†…å­˜ç»“æ„å¼€é”€ã€‚

***

### 3. ğŸ”¥ è¿›é˜¶è€ƒç‚¹ï¼šä¼ªå…±äº« (False Sharing) ä¸ ç¼“å­˜è¡Œ (Cache Line)

è¿™æ˜¯ **P8 / ä¸“å®¶çº§** çš„å›ç­”ç‚¹ã€‚

ä½ çš„å›ç­”ï¼š

â€œé™¤äº†å‡å°‘é”ç«äº‰ï¼Œé€‰ 64 è¿™ä¸ªæ•°å­—è¿˜å¯èƒ½éšå«äº†å¯¹ CPU ç¼“å­˜è¡Œï¼ˆCache Lineï¼‰ çš„è€ƒé‡ã€‚

ç°ä»£ CPU çš„ L1 Cache Line é€šå¸¸æ˜¯ 64 Bytesã€‚

å¦‚æœé”çš„æ•°é‡å¤ªå°‘ä¸”å†…å­˜æ’åˆ—å¤ªç´§å¯†ï¼Œå¯èƒ½ä¼šå‘ç”Ÿ **ä¼ªå…±äº« (False Sharing)**ï¼š

- æ ¸å¿ƒ A ä¿®æ”¹äº† `SideTable[0]` çš„é”ã€‚

- æ ¸å¿ƒ B ä¿®æ”¹äº† `SideTable[1]` çš„é”ã€‚

- å¦‚æœè¿™ä¸¤ä¸ªé”åœ¨åŒä¸€ä¸ª Cache Line é‡Œï¼ŒCPU å¿…é¡»é€šè¿‡æ€»çº¿å¼ºåˆ¶åŒæ­¥ï¼Œå¯¼è‡´ä¸¤ä¸ªæ ¸å¿ƒäº’ç›¸ç­‰å¾…ï¼Œè™½ç„¶é€»è¾‘ä¸Šå®ƒä»¬é”çš„æ˜¯ä¸åŒçš„è¡¨ã€‚

`SideTables` çš„ç»“æ„è®¾è®¡é…åˆ **64** è¿™ä¸ªæ•°é‡ï¼Œèƒ½å¤Ÿè®©é«˜é¢‘è®¿é—®çš„é”åœ¨å†…å­˜åˆ†å¸ƒä¸Šè¶³å¤Ÿåˆ†æ•£ï¼Œæˆ–è€…é…åˆ Paddingï¼ˆå¡«å……ï¼‰ï¼Œè®©æ¯ä¸ªé”ç‹¬å  Cache Lineï¼Œä»è€Œå‹æ¦¨å‡ºæœ€é«˜çš„ç¡¬ä»¶æ€§èƒ½ã€‚â€

### SideTable é‡Œå­˜å‚¨å•¥
**`SideTable` é‡Œå­˜å‚¨çš„ä¸ä»…ä»…æ˜¯å¼±å¼•ç”¨å¯¹è±¡çš„åœ°å€ã€‚å®ƒä¸»è¦å­˜å‚¨ä¸¤ä¸ªå®Œå…¨ä¸åŒçš„ä¸œè¥¿ï¼Œå®ƒä»¬å…±ç”¨ä¸€ä¸ªé”ï¼ˆè¿™å°±æ˜¯ä¸ºä»€ä¹ˆåˆ†æ®µé”éå¸¸å…³é”®ï¼‰ï¼š**

1. **å¤–éƒ¨å¼•ç”¨è®¡æ•° (External Reference Count Map)**

2. **å¼±å¼•ç”¨è¡¨ (Weak Reference Map)**

ä»¥ä¸‹æ˜¯ `SideTable` çš„è¯¦ç»†æ„æˆå’Œæ¯ä¸ªéƒ¨åˆ†çš„ä½œç”¨ï¼š

***

### 1. å¤–éƒ¨å¼•ç”¨è®¡æ•°è¡¨ (RefcountMap)

è¿™éƒ¨åˆ†é€šå¸¸ç”± `RefcountMap` ç»“æ„ä½“å®ç°ï¼Œç”¨æ¥å­˜å‚¨å¯¹è±¡çš„ **éå†…åµŒ** å¼•ç”¨è®¡æ•°ã€‚

#### ğŸ”¹ ä½œç”¨ï¼šè§£å†³ `isa` ç©ºé—´çš„ä¸è¶³

ç°ä»£ Objective-Cï¼ˆ64 ä½æ¶æ„ï¼‰çš„å†…å­˜ä¼˜åŒ–éå¸¸æ¿€è¿›ï¼š

- **å†…åµŒå¼•ç”¨è®¡æ•°**ï¼šå¯¹äºå¤§éƒ¨åˆ†å¯¹è±¡ï¼Œå®ƒä»¬çš„ `retain` è®¡æ•°æ˜¯ç›´æ¥åµŒå…¥åœ¨ `isa` æŒ‡é’ˆä¸­çš„ï¼ˆæœ‰ä¸“é—¨çš„ä½åŸŸå­˜å‚¨ï¼‰ã€‚

- **æº¢å‡ºå­˜å‚¨**ï¼šåªæœ‰å½“å¯¹è±¡çš„å¼•ç”¨è®¡æ•°è¶…è¿‡äº† `isa` èƒ½å¤Ÿå­˜å‚¨çš„èŒƒå›´æ—¶ï¼ˆæ¯”å¦‚ä¸€ä¸ªå¯¹è±¡è¢« `retain` äº†å‡ åƒæ¬¡ï¼‰ï¼Œæˆ–è€… `isa` é‡Œçš„ä½åŸŸè¢«ç”¨äºå…¶ä»–ç”¨é€”ï¼ˆå¦‚ `Tagged Pointer` æ ‡è®°ã€é”çŠ¶æ€ç­‰ï¼‰ï¼ŒRuntime æ‰ä¼šæŠŠè¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨è®¡æ•° **è¿ç§»** åˆ° `SideTable` çš„ `RefcountMap` ä¸­ã€‚

**ç»“è®ºï¼š** å¹¶éæ‰€æœ‰å¯¹è±¡çš„å¼•ç”¨è®¡æ•°éƒ½åœ¨ `SideTable` é‡Œï¼Œåªæœ‰é‚£äº› **æº¢å‡ºæˆ–ç‰¹æ®ŠçŠ¶æ€** çš„å¯¹è±¡æ‰ä¼šåœ¨æ­¤å­˜å‚¨ã€‚

### 2. å¼±å¼•ç”¨è¡¨ (WeakPointerMap)

è¿™éƒ¨åˆ†é€šå¸¸ç”± `WeakPointerMap` ç»“æ„ä½“å®ç°ï¼Œç”¨äºå­˜å‚¨æ‰€æœ‰æŒ‡å‘æŸä¸ªå¯¹è±¡çš„å¼±å¼•ç”¨æŒ‡é’ˆã€‚

#### ğŸ”¹ ä½œç”¨ï¼šå®ç°å¼±å¼•ç”¨å½’é›¶ (Zeroing Out)

è¿™æ˜¯ `SideTable` å­˜åœ¨çš„å¦ä¸€ä¸ªä¸»è¦åŸå› ï¼š

1. **å­˜å‚¨å…³ç³»**ï¼šå®ƒå­˜å‚¨äº†ä» **å¯¹è±¡åœ°å€** åˆ° **å¼±å¼•ç”¨æŒ‡é’ˆåˆ—è¡¨** çš„æ˜ å°„å…³ç³»ã€‚

   - *Key*ï¼šè¢«å¼±å¼•ç”¨çš„å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚

   - *Value*ï¼šä¸€ä¸ªåˆ—è¡¨ï¼Œé‡Œé¢å­˜äº†æ‰€æœ‰ `__weak` å˜é‡çš„åœ°å€ã€‚

2. **å¯¹è±¡é”€æ¯æ—¶**ï¼šå½“å¯¹è±¡å‘ç”Ÿ `dealloc` æ—¶ï¼ŒRuntime ä¼šå»å®ƒå¯¹åº”çš„ `SideTable` ä¸­æŸ¥æ‰¾ `WeakPointerMap`ã€‚

3. **å½’é›¶**ï¼šRuntime æ‹¿åˆ°å¼±å¼•ç”¨æŒ‡é’ˆåˆ—è¡¨åï¼Œä¼šéå†è¿™ä¸ªåˆ—è¡¨ï¼Œå°†æ‰€æœ‰æŒ‡å‘è¯¥å¯¹è±¡çš„ `__weak` å˜é‡çš„å€¼**å…¨éƒ¨è®¾ä¸º `nil`**ï¼Œä»è€Œé¿å…é‡æŒ‡é’ˆã€‚

### 3. `SideTable` çš„ç»“æ„æ¨¡å‹ (æ€»ç»“)

åœ¨ Runtime æºç ä¸­ï¼Œæ¯ä¸ª `SideTable` æ¡¶çš„ç»“æ„é€šå¸¸åŒ…å«è¿™ä¸‰ä¸ªå­—æ®µï¼š

| **å­—æ®µåç§°**         | **ç±»å‹**                 | **å­˜å‚¨å†…å®¹**                   | **ä¿æŠ¤èŒƒå›´**                   |
| ---------------- | ---------------------- | -------------------------- | -------------------------- |
| **`lock`**       | `spinlock_t` æˆ– `mutex` | ç”¨äºä¿æŠ¤æœ¬ `SideTable` æ¡¶å†…çš„æ•°æ®ç»“æ„ã€‚ | **æ•´ä¸ª `SideTable` æ¡¶**       |
| **`refcnts`**    | `RefcountMap`          | å­˜å‚¨**æº¢å‡º**å¯¹è±¡çš„å¼•ç”¨è®¡æ•°ã€‚           | `refcnts` (å— `lock` ä¿æŠ¤)    |
| **`weak_table`** | `WeakPointerMap`       | å­˜å‚¨å¼±å¼•ç”¨æŒ‡é’ˆçš„æ˜ å°„å…³ç³»ã€‚              | `weak_table` (å— `lock` ä¿æŠ¤) |

### ğŸ”‘ æ¶æ„æ€»ç»“

`SideTable` çš„è®¾è®¡ä½“ç°äº† **èŒè´£åˆ’åˆ†** å’Œ **æ€§èƒ½å¹³è¡¡**ï¼š

- **åˆ†æ®µé”**ï¼š`SideTables` æ•°ç»„ï¼ˆ64ä¸ªï¼‰é€šè¿‡åˆ†æ®µé”æŠ€æœ¯ï¼Œå°†**å¼•ç”¨è®¡æ•°**å’Œ**å¼±å¼•ç”¨ç®¡ç†**çš„å‹åŠ›åˆ†æ•£åˆ°å¤šä¸ªé”ä¸Šï¼Œé¿å…äº†å…¨å±€é”çš„ç“¶é¢ˆã€‚

- **èŒè´£åˆå¹¶**ï¼šå¼•ç”¨è®¡æ•°å’Œå¼±å¼•ç”¨éƒ½æ˜¯å¯¹è±¡ç”Ÿå‘½å‘¨æœŸç®¡ç†çš„ä¸€éƒ¨åˆ†ï¼Œå°†å®ƒä»¬æ”¾åœ¨åŒä¸€ä¸ª `SideTable` å†…çš„ä¸¤ä¸ª Map ä¸­ï¼Œå¯ä»¥å…±ç”¨åŒä¸€æŠŠé”ï¼Œå‡å°‘äº†å¯¹å†…å­˜çš„åå¤è®¿é—®ï¼Œæé«˜äº†å±€éƒ¨æ€§ã€‚




***

### 4. å®ƒä»¬æ˜¯æ€ä¹ˆæ˜ å°„çš„ï¼Ÿ(å“ˆå¸Œç®—æ³•)

ä¸ºäº†è¯æ˜ä½ çœ‹è¿‡æºç ï¼Œå¯ä»¥ç®€å•æä¸€ä¸‹æ˜ å°„é€»è¾‘ï¼š

$Index = (Object\\\_Address >> 4) \\% StripeCount$

- **å³ç§» 4 ä½**ï¼šå› ä¸ºå¯¹è±¡æŒ‡é’ˆé€šå¸¸æ˜¯ 16 å­—èŠ‚å¯¹é½çš„ï¼ˆæœ€å 4 ä½å…¨æ˜¯ 0ï¼‰ã€‚å¦‚æœä¸å³ç§»ï¼Œä½ä½å…¨æ˜¯ 0ï¼Œä¼šå¯¼è‡´å“ˆå¸Œåˆ†å¸ƒä¸å‡ã€‚

- **å–æ¨¡**ï¼šå‡åŒ€åˆ†æ•£åˆ° 64 ä¸ªè¡¨ä¸­ã€‚

***

### æ€»ç»“ï¼šé¢è¯•è¯æœ¯

> â€œ`SideTables` ä½¿ç”¨ 8 æˆ– 64 ä¸ªè¡¨ï¼Œé‡‡ç”¨çš„æ˜¯\*\*åˆ†æ®µé”ï¼ˆLock Stripingï¼‰\*\*æœºåˆ¶ã€‚
>
> 1. **è§£å†³å¹¶å‘ç“¶é¢ˆ**ï¼šå¦‚æœåªæœ‰ 1 ä¸ªè¡¨ï¼Œå…¨å±€é”ä¼šå¡æ­»æ‰€æœ‰çº¿ç¨‹ï¼›å¦‚æœè¡¨å¤ªå¤šï¼Œå†…å­˜å¼€é”€å¤§ã€‚64 æ˜¯ä¸€ä¸ªåœ¨ç°ä»£å¤šæ ¸ CPU ä¸Šï¼Œèƒ½è®©**é”ç«äº‰å‡ ç‡é™åˆ°æä½**çš„ç»éªŒå€¼ã€‚
>
> 2. **é€‚é…ç¡¬ä»¶**ï¼š32 ä½ç³»ç»Ÿå†…å­˜å°‘ï¼Œæ‰€ä»¥ç”¨ 8 ä¸ªï¼›64 ä½ç³»ç»Ÿèµ„æºè¶³ï¼Œç”¨ 64 ä¸ªä»¥æ¢å–æ›´é«˜å¹¶å‘ã€‚
>
> 3. **é¿å…ä¼ªå…±äº«**ï¼šåˆ†æ•£çš„é”å¸ƒå±€è¿˜èƒ½å‡å°‘ CPU Cache Line çš„é¢‘ç¹å¤±æ•ˆï¼ˆFalse Sharingï¼‰ï¼Œè¿›ä¸€æ­¥æå‡åº•å±‚æ•ˆç‡ã€‚â€

```mermaid
flowchart TD
    subgraph Object[å¯¹è±¡å†…å­˜ & ISA]
        ISA_Count["isa.extra_rc (éšèº«é’±åŒ…)"]
        ISA_Flags["isa æ ‡è®°ä½<br/>(has_sidetable_rc / weakly_referenced)"]
    end

    subgraph SideTableZone[SideTable åˆ†æ®µé”é“¶è¡Œ]
        Lock["ğŸ”’ Lock"]
        RefMap[("RefcountMap<br/>(å­˜æ¬¾å•)")]
        WeakMap[("WeakRefMap<br/>(é—å˜±/é€šè®¯å½•)")]
    end

    %% Retain æµç¨‹
    Start_Retain(Retain +1) --> CheckISA_Full{isa æ»¡äº†å—?}
    CheckISA_Full -- æ²¡æ»¡ (Fast) --> IncISA[isa.extra_rc++]
    CheckISA_Full -- æ»¡äº† (Overflow) --> MoveHalfToBank[1 æ‹¿å‡ºä¸€åŠè®¡æ•°<br/>2. æ ‡è®° has_sidetable_rc = 1]
    MoveHalfToBank --> LockRetain[åŠ é”]
    LockRetain --> StoreInMap[å­˜å…¥ RefcountMap]
    StoreInMap --> UnlockRetain[è§£é”] --> IncISA

    %% Release æµç¨‹
    Start_Release(Release -1) --> CheckISA_Empty{isa ç©ºäº†å—?}
    CheckISA_Empty -- æ²¡ç©º (Fast) --> DecISA[isa.extra_rc--]
    CheckISA_Empty -- ç©ºäº† (Underflow) --> CheckBankFlag{æœ‰é“¶è¡Œå­˜æ¬¾æ ‡è®°?}
    
    CheckBankFlag -- No --> Dealloc[è§¦å‘ Dealloc]
    
    CheckBankFlag -- Yes --> LockRel[åŠ é”]
    LockRel --> BorrowHalf[ä» RefcountMap<br/>å–å‡º ä¸€åŠ è®¡æ•°]
    BorrowHalf --> UnlockRel[è§£é”]
    UnlockRel --> RefillISA[å›å¡« isa] --> DecISA

    %% Weak æµç¨‹
    Start_Weak(Weak èµ‹å€¼) --> SetWeakFlag[æ ‡è®° isa.weakly_referenced = 1]
    SetWeakFlag --> LockWeak[åŠ é”]
    LockWeak --> RegisterWeak[åœ¨ WeakRefMap æ³¨å†Œ<br/>Key: Obj, Value: &ptr]
    RegisterWeak --> UnlockWeak[è§£é”]

    %% Dealloc æµç¨‹è¯¦ç»†
    Dealloc --> CheckWeakFlag{è¢« Weak å¼•ç”¨è¿‡?}
    CheckWeakFlag -- No --> FreeMem(free å†…å­˜)
    CheckWeakFlag -- Yes --> LockDealloc[åŠ é”]
    LockDealloc --> ClearWeak[1 æŸ¥ WeakRefMap<br/>2. å°†æ‰€æœ‰ weakPtr è®¾ä¸º nil<br/>3. åˆ é™¤è®°å½•]
    ClearWeak --> UnlockDealloc[è§£é”] --> FreeMem

    style Object fill:#e3f2fd,stroke:#2196f3
    style SideTableZone fill:#fff3e0,stroke:#ff9800
    style Start_Retain fill:#c8e6c9,stroke:#4caf50
    style Start_Release fill:#ffcdd2,stroke:#f44336
    style Start_Weak fill:#e1bee7,stroke:#9c27b0
    style Dealloc fill:#263238,stroke:#000,color:#fff
```

***

### **2.3 AutoreleasePool åŸç†**

ğŸ’£Â **æ·±æŒ–é¢˜ Q5: AutoreleasePool åŸç†ï¼Ÿ**\
**è¯¦ç»†è§£ç­”**ï¼š

- **ç»“æ„**ï¼š
  - `AutoreleasePoolPage`ï¼š4096 å­—èŠ‚ï¼ŒåŒå‘é“¾è¡¨ã€‚
  - æ¯ä¸ª page å­˜å‚¨ autorelease å¯¹è±¡æŒ‡é’ˆã€‚
- **push**ï¼š
  - æ’å…¥ä¸€ä¸ª POOL\_BOUNDARYï¼ˆå“¨å…µå¯¹è±¡ï¼‰ã€‚
- **autorelease**ï¼š
  - å°†å¯¹è±¡æŒ‡é’ˆå‹å…¥å½“å‰ pageã€‚
  - å¦‚æœ page æ»¡ï¼Œæ–°å»º page é“¾æ¥èµ·æ¥ã€‚
- **pop(token)**ï¼š
  - ä»æ ˆé¡¶å¼€å§‹å‘é€Â `release`ï¼Œç›´åˆ°é‡åˆ°å“¨å…µã€‚
- **RunLoop å…³ç³»**ï¼š
  - åœ¨ Entry / BeforeWaiting / Exit è‡ªåŠ¨ push/popã€‚

***

### **2.4 Associated Objects åŸç†**

ğŸ’£Â **æ·±æŒ–é¢˜ Q6: Associated Objects åŸç†ï¼Ÿ**\
**è¯¦ç»†è§£ç­”**ï¼š

- å­˜å‚¨åœ¨å…¨å±€Â `AssociationsManager`ï¼ˆå“ˆå¸Œè¡¨ï¼‰ã€‚
- keyï¼šå¯¹è±¡åœ°å€ï¼Œvalueï¼šå…³è”å¯¹è±¡åˆ—è¡¨ï¼ˆmapï¼‰ã€‚
- é‡Šæ”¾å¯¹è±¡æ—¶ï¼š
  - `objc_destructInstance`Â ä¼šè°ƒç”¨Â `_object_remove_assocations`ã€‚
  - éå†å¹¶é‡Šæ”¾æ‰€æœ‰å…³è”å¯¹è±¡ã€‚

***

## **3ï¸âƒ£ Blockï¼ˆé—­åŒ…ä¸æ•è·ï¼‰**

**æ ¸å¿ƒè€ƒç‚¹**ï¼šç±»å‹ã€æ•è·æœºåˆ¶ã€\_\_block åŸç†ã€å¾ªç¯å¼•ç”¨

***

### **3.1 Block ç±»å‹**

- **Global**ï¼šä¸æ•è·å˜é‡ã€‚
- **Stack**ï¼šæ•è·å¤–éƒ¨å˜é‡ï¼Œç”Ÿå‘½å‘¨æœŸéšæ ˆç»“æŸã€‚
- **Malloc**ï¼šcopy åˆ°å †ä¸Šï¼Œå»¶é•¿ç”Ÿå‘½å‘¨æœŸã€‚

***

### **3.2 æ•è·æœºåˆ¶**

- å±€éƒ¨å˜é‡ï¼šå€¼æ‹·è´ã€‚
- å¯¹è±¡ï¼šæŒ‡é’ˆæ‹·è´ï¼ˆretainï¼‰ã€‚
- static å˜é‡ï¼šæŒ‡é’ˆä¼ é€’ã€‚
- å…¨å±€å˜é‡ï¼šç›´æ¥è®¿é—®ã€‚

***

### **3.3 \_\_block åŸç†**

ğŸ’£Â **æ·±æŒ–é¢˜ Q7: \_\_block åŸç†ï¼Ÿ**\
**è¯¦ç»†è§£ç­”**ï¼š

- ç¼–è¯‘å™¨å°† \_\_block å˜é‡åŒ…è£…æˆÂ `__Block_byref`Â ç»“æ„ä½“ï¼š

c

å¤åˆ¶

`struct __Block_byref_var {     void *__isa;     struct __Block_byref_var *__forwarding;     int flags;     int size;     int var; };`

- æ ˆä¸Šæ—¶Â `__forwarding`Â æŒ‡å‘è‡ªå·±ã€‚
- copy åˆ°å †ä¸Šæ—¶ï¼š
  - åˆ›å»ºå †å‰¯æœ¬ã€‚
  - æ ˆä¸Šçš„Â `__forwarding`Â æŒ‡å‘å †å‰¯æœ¬ã€‚
  - ä¿è¯ Block å†…å¤–è®¿é—®çš„æ˜¯åŒä¸€ä¸ªå˜é‡ã€‚

***

### **3.4 Block å†…å­˜å¸ƒå±€**

ğŸ’£Â **æ·±æŒ–é¢˜ Q8: Block å†…å­˜å¸ƒå±€ï¼Ÿ**\
**è¯¦ç»†è§£ç­”**ï¼š

c

å¤åˆ¶

`struct Block_layout {     void *isa;     int flags;     int reserved;     void (*invoke)(void *, ...);     struct Block_descriptor *descriptor; }; struct Block_descriptor {     unsigned long int reserved;     unsigned long int size;     void (*copy)(void *dst, void *src);     void (*dispose)(void *src); };`

- `invoke`ï¼šBlock æ‰§è¡Œå‡½æ•°æŒ‡é’ˆã€‚
- `descriptor`ï¼šåŒ…å« sizeã€copy/dispose å‡½æ•°ã€‚
- copy/dispose ç”¨äºç®¡ç†æ•è·çš„å¯¹è±¡ï¼ˆretain/releaseï¼‰ã€‚

***

### **3.5 å¾ªç¯å¼•ç”¨**

ğŸ’£Â **æ·±æŒ–é¢˜ Q9: Block å¾ªç¯å¼•ç”¨æ£€æµ‹ä¸è§£å†³ï¼Ÿ**\
**è¯¦ç»†è§£ç­”**ï¼š

- **æ£€æµ‹**ï¼š
  - Instrumentsï¼ˆLeaksï¼‰
  - Xcode Memory Graph
  - é™æ€åˆ†æå·¥å…·
- **è§£å†³**ï¼š
  - `__weak`Â æ‰“ç ´ç¯ã€‚
  - `__strong`Â åœ¨ Block å†…é˜²æ­¢æå‰é‡Šæ”¾ã€‚

objc

å¤åˆ¶

`__weak typeof(self) weakSelf = self; self.block = ^{     __strong typeof(weakSelf) strongSelf = weakSelf;     [strongSelf doSomething]; };`

***

## **4ï¸âƒ£ å»¶ä¼¸åº•å±‚æœºåˆ¶**

***

### **4.1 KVO åŸç†**

ğŸ’£Â **æ·±æŒ–é¢˜ Q10: KVO åº•å±‚åŸç†ï¼Ÿ**\
**è¯¦ç»†è§£ç­”**ï¼š

- åŠ¨æ€ç”Ÿæˆå­ç±»ï¼ˆ`NSKVONotifying_Class`ï¼‰ã€‚
- é‡å†™ setterï¼š
  - è°ƒç”¨Â `willChangeValueForKey`ã€‚
  - è°ƒç”¨åŸ setterã€‚
  - è°ƒç”¨Â `didChangeValueForKey`ã€‚
- é‡Šæ”¾æ—¶æ¢å¤åŸç±»ã€‚

***

### **4.2 GCD åº•å±‚**

ğŸ’£Â **æ·±æŒ–é¢˜ Q11: dispatch\_once åº•å±‚ï¼Ÿ**\
**è¯¦ç»†è§£ç­”**ï¼š

- `dispatch_once`Â â†’Â `pthread_once`ã€‚
- ä½¿ç”¨é™æ€å˜é‡è®°å½•æ˜¯å¦æ‰§è¡Œè¿‡ï¼ŒCAS ä¿è¯çº¿ç¨‹å®‰å…¨ã€‚

***

### **4.3 å†…å­˜å¯¹é½ä¸å¯¹è±¡å¸ƒå±€**

ğŸ’£Â **æ·±æŒ–é¢˜ Q12: å†…å­˜å¯¹é½è§„åˆ™ï¼Ÿ**\
**è¯¦ç»†è§£ç­”**ï¼š

- å¯¹è±¡å†…å­˜æŒ‰æœ€å¤§æˆå‘˜ç±»å‹å¯¹é½ã€‚
- å¯¹é½æé«˜ CPU è®¿é—®æ•ˆç‡ï¼Œå‡å°‘è·¨å­—èŠ‚è®¿é—®ã€‚